<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Photos</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #001a4d 0%, #0d3b66 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 25px; box-shadow: 0 20px 40px rgba(0,0,0,0.1), 0 0 30px rgba(192, 192, 192, 0.2); padding: 40px; border: 3px solid; border-image: linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 50%, #c0c0c0 100%) 1; }
        h1 { text-align: center; color: #001a4d; margin-bottom: 10px; font-size: 2.5em; background: linear-gradient(135deg, #001a4d 0%, #c0c0c0 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .subtitle { text-align: center; color: #555; margin-bottom: 30px; font-size: 1.1em; }
        
        .album-selector { background: linear-gradient(135deg, #f5f5f5 0%, #fafafa 100%); padding: 25px; border-radius: 15px; border: 2px solid #c0c0c0; margin-bottom: 20px; }
        .album-selector-label { display: block; font-size: 1.1em; font-weight: bold; color: #001a4d; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .label-icon { width: 24px; height: 24px; display: inline-block; }
        .album-selector-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; }
        .album-option { padding: 12px; border: 2px solid #c0c0c0; border-radius: 10px; background: white; cursor: pointer; transition: all 0.3s ease; text-align: center; font-size: 0.95em; }
        .album-option:hover { border-color: #001a4d; background: #fafafa; transform: scale(1.02); }
        .album-option.selected { background: linear-gradient(135deg, #001a4d 0%, #0d3b66 100%); color: #c0c0c0; border-color: #001a4d; font-weight: bold; box-shadow: 0 5px 15px rgba(0, 26, 77, 0.3); }
        .album-option-icon { font-size: 1.8em; display: block; margin-bottom: 5px; animation: float 2s ease-in-out infinite; }
        .album-option:hover .album-option-icon { animation: bounce 0.6s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        
        .current-album-info { text-align: center; background: linear-gradient(135deg, #001a4d 0%, #0d3b66 100%); color: #c0c0c0; padding: 15px; border-radius: 12px; margin-bottom: 20px; font-size: 1.2em; font-weight: bold; box-shadow: 0 0 15px rgba(192, 192, 192, 0.2); display: flex; align-items: center; justify-content: center; gap: 12px; }
        .album-info-icon { width: 32px; height: 32px; display: inline-block; }
        
        .upload-area { border: 4px dashed #001a4d; border-radius: 20px; padding: 60px 30px; text-align: center; margin-bottom: 20px; transition: all 0.3s ease; background: #fafafa; }
        .upload-area:hover { border-color: #c0c0c0; background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%); transform: scale(1.02); }
        .upload-area.dragover { border-color: #c0c0c0; background: #f0f0f0; border-width: 5px; }
        .upload-area-icon { width: 48px; height: 48px; margin: 0 auto 15px; display: inline-block; animation: bounce 2s infinite; }
        .upload-area div { font-size: 1.3em; margin-bottom: 20px; }
        #fileInput { display: none; }
        .upload-btn { background: linear-gradient(135deg, #001a4d 0%, #0d3b66 100%); color: #c0c0c0; padding: 15px 40px; border: none; border-radius: 50px; font-size: 1.2em; cursor: pointer; transition: all 0.3s ease; margin-top: 15px; font-weight: bold; box-shadow: 0 5px 15px rgba(0, 26, 77, 0.4); display: inline-flex; align-items: center; gap: 10px; }
        .btn-icon-medium { width: 24px; height: 24px; display: inline-block; }
        .upload-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0, 26, 77, 0.6); }
        .upload-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .name-input { width: 100%; padding: 15px; margin: 20px 0; border: 2px solid #c0c0c0; border-radius: 12px; font-size: 1.1em; transition: all 0.3s ease; }
        .name-input:focus { outline: none; border-color: #001a4d; box-shadow: 0 0 10px rgba(0, 26, 77, 0.3); }
        .loading { display: none; text-align: center; padding: 40px; }
        .spinner { border: 5px solid #f3f3f3; border-top: 5px solid #001a4d; border-radius: 50%; width: 60px; height: 60px; animation: spin 1s linear infinite; margin: 0 auto 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .success { background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); color: #155724; padding: 18px; border-radius: 12px; margin: 20px 0; display: none; border: 2px solid #28a745; animation: slideIn 0.3s ease; font-weight: bold; font-size: 1.05em; }
        .error { background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%); color: #721c24; padding: 18px; border-radius: 12px; margin: 20px 0; display: none; border: 2px solid #f5365c; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .view-gallery { text-align: center; margin: 25px 0; display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }
        .view-gallery a { background: linear-gradient(135deg, #e8e8e8 0%, #f5f5f5 50%, #e8e8e8 100%); color: #001a4d; padding: 14px 30px; border-radius: 50px; text-decoration: none; font-weight: bold; display: inline-flex; align-items: center; gap: 8px; transition: all 0.3s ease; box-shadow: 0 5px 15px rgba(192, 192, 192, 0.4); border: 2px solid rgba(192, 192, 192, 0.5); position: relative; }
        .view-gallery a::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent); animation: shimmer 3s infinite; border-radius: 50px; }
        @keyframes shimmer { 0% { left: -100%; } 100% { left: 100%; } }
        .view-gallery a:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(192, 192, 192, 0.6); }
        .stats { text-align: center; margin-top: 25px; padding: 20px; background: #fafafa; border-radius: 12px; border: 2px solid #c0c0c0; }
        .stat-number { font-size: 2em; font-weight: bold; color: #001a4d; }
        .stat-label { color: #666; font-size: 0.95em; }
        @media (max-width: 600px) { .container { padding: 20px; } h1 { font-size: 2em; } .upload-area { padding: 40px 20px; } .view-gallery a { display: flex; margin: 10px auto; justify-content: center; } .view-gallery { flex-direction: column; } }
    </style>
</head>
<body>
    <div class="container">
        <h1>QR Photo Album</h1>
        <p class="subtitle">Upload to your chosen album</p>
        
        <div class="album-selector">
            <label class="album-selector-label">
                <svg class="label-icon" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                    <g fill="currentColor">
                        <path d="M12 14 L12 54 Q12 58 16 58 L48 58 Q52 58 52 54 L52 20 L36 20 L36 14 Q36 12 34 12 L16 12 Q12 12 12 14 Z" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                        <path d="M32 28 L32 48 M24 38 L40 38" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </g>
                </svg>
                Select Album:
            </label>
            <div class="album-selector-grid" id="albumGrid"></div>
        </div>
        
        <div class="current-album-info" id="currentAlbumInfo">
            <svg class="album-info-icon" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                <g fill="currentColor"><circle cx="32" cy="20" r="3"/><path d="M20 28 Q20 24 24 24 L40 24 Q44 24 44 28 L44 48 Q44 52 40 52 L24 52 Q20 52 20 48 Z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M20 40 L26 32 L40 44 L44 40" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></g>
            </svg>
            <span id="currentAlbumName">Celebration</span>
        </div>
        
        <div class="view-gallery">
            <a href="#" id="viewGalleryLink">
                <svg class="btn-icon-medium" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                    <g fill="currentColor">
                        <path d="M12 12 Q12 10 14 10 L50 10 Q52 10 52 12 L52 52 Q52 54 50 54 L14 54 Q12 54 12 52 Z" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linejoin="round"/>
                        <circle cx="28" cy="28" r="8" fill="none" stroke="currentColor" stroke-width="2"/>
                        <circle cx="42" cy="20" r="3" fill="currentColor"/>
                        <path d="M12 42 L24 30 L38 42 L52 28 L52 52" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                    </g>
                </svg>
                View This Album
            </a>
            <a href="albums.html">
                <svg class="btn-icon-medium" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                    <g fill="currentColor">
                        <rect x="10" y="14" width="20" height="20" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                        <rect x="34" y="14" width="20" height="20" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                        <rect x="10" y="38" width="20" height="20" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                        <rect x="34" y="38" width="20" height="20" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                    </g>
                </svg>
                All Albums
            </a>
        </div>
        
        <div class="success" id="successMsg"></div>
        <div class="error" id="errorMsg"></div>
        
        <div class="upload-area" id="uploadArea">
            <svg class="upload-area-icon" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                <g fill="currentColor">
                    <path d="M32 10 L32 44 M20 32 L32 10 L44 32" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linejoin="round" stroke-linecap="round"/>
                    <rect x="12" y="50" width="40" height="4" rx="2" fill="currentColor"/>
                </g>
            </svg>
            <div>Tap here or drag & drop photos/videos</div>
            <input type="file" id="fileInput" multiple accept="image/*,video/*">
            <button class="upload-btn" id="chooseBtn" onclick="document.getElementById('fileInput').click()">
                <svg class="btn-icon-medium" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                    <g fill="currentColor">
                        <rect x="14" y="18" width="36" height="34" rx="2" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                        <path d="M32 28 L32 42 M26 34 L38 34" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </g>
                </svg>
                Choose Files
            </button>
        </div>
        
        <div class="loading" id="loading" style="display: none;">
            <div class="spinner"></div>
            <div style="font-size: 1.1em; color: #001a4d; font-weight: bold;">Saving to cloud...</div>
        </div>
        
        <input type="text" class="name-input" id="uploaderName" placeholder="‚úèÔ∏è Your name (optional)">
        
        <div class="stats">
            <div class="stat-number" id="photoCount">0</div>
            <div class="stat-label">Photos in this album</div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'qr_photo_albums';
        
        const albumsList = [
            { id: 1, name: 'Celebration' },
            { id: 2, name: 'Nature' },
            { id: 3, name: 'Friends' },
            { id: 4, name: 'Food' },
            { id: 5, name: 'Travel' },
            { id: 6, name: 'Family' },
            { id: 7, name: 'Selfies' },
            { id: 8, name: 'Work' },
            { id: 9, name: 'Art' },
            { id: 10, name: 'Pets' },
            { id: 11, name: 'Sports' },
            { id: 12, name: 'Fashion' },
            { id: 13, name: 'Music' },
            { id: 14, name: 'Other' }
        ];
        
        let currentAlbumId = 1;
        
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const loading = document.getElementById('loading');
        const successMsg = document.getElementById('successMsg');
        const errorMsg = document.getElementById('errorMsg');
        const uploaderName = document.getElementById('uploaderName');
        const photoCount = document.getElementById('photoCount');
        const chooseBtn = document.getElementById('chooseBtn');
        const currentAlbumName = document.getElementById('currentAlbumName');
        const viewGalleryLink = document.getElementById('viewGalleryLink');
        const albumGrid = document.getElementById('albumGrid');

        function renderAlbumSelector() {
            albumGrid.innerHTML = '';
            albumsList.forEach(album => {
                const option = document.createElement('div');
                option.className = 'album-option' + (album.id === currentAlbumId ? ' selected' : '');
                option.id = `album-${album.id}`;
                option.onclick = () => selectAlbum(album.id, album.name);
                option.innerHTML = `
                    <span class="album-option-icon">üìÅ</span>
                    <span class="album-option-name">${album.name}</span>
                `;
                albumGrid.appendChild(option);
            });
        }

        function selectAlbum(id, name) {
            currentAlbumId = id;
            document.querySelectorAll('.album-option').forEach(el => el.classList.remove('selected'));
            document.getElementById(`album-${id}`).classList.add('selected');
            currentAlbumName.textContent = name;
            viewGalleryLink.href = `album.html?album=${id}`;
            updatePhotoCount();
        }

        function updatePhotoCount() {
            try {
                const allAlbums = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
                const count = (allAlbums[currentAlbumId] || []).length;
                photoCount.textContent = count;
            } catch (e) {
                console.error('Count error:', e);
            }
        }

        function savePhotos(photos) {
            try {
                const allAlbums = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
                allAlbums[currentAlbumId] = photos;
                localStorage.setItem(STORAGE_KEY, JSON.stringify(allAlbums));
                updatePhotoCount();
            } catch (e) {
                showError('Storage full! Delete some photos.');
            }
        }

        function showError(msg) {
            errorMsg.textContent = msg;
            errorMsg.style.display = 'block';
            setTimeout(() => { errorMsg.style.display = 'none'; }, 4000);
        }

        ['dragover', 'dragenter'].forEach(event => {
            uploadArea.addEventListener(event, (e) => {
                e.preventDefault();
                e.stopPropagation();
                uploadArea.classList.add('dragover');
            });
        });
        ['dragleave', 'drop'].forEach(event => {
            uploadArea.addEventListener(event, (e) => {
                e.preventDefault();
                e.stopPropagation();
                uploadArea.classList.remove('dragover');
            });
        });
        uploadArea.addEventListener('drop', (e) => {
            fileInput.files = e.dataTransfer.files;
            handleFiles();
        });

        fileInput.addEventListener('change', handleFiles);

        function handleFiles() {
            if (fileInput.files.length === 0) return;
            
            loading.style.display = 'block';
            uploadArea.style.display = 'none';
            successMsg.style.display = 'none';
            errorMsg.style.display = 'none';
            chooseBtn.disabled = true;

            try {
                const allAlbums = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
                const currentPhotos = allAlbums[currentAlbumId] || [];
                let uploadedCount = 0;
                let filesProcessed = 0;
                const totalFiles = fileInput.files.length;
                
                Array.from(fileInput.files).forEach(file => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const photoId = Date.now() + Math.random();
                        const newPhoto = {
                            id: photoId,
                            name: file.name,
                            dataUrl: e.target.result,
                            uploader: uploaderName.value || 'Anonymous',
                            timestamp: Date.now(),
                            size: file.size
                        };
                        
                        currentPhotos.unshift(newPhoto);
                        uploadedCount++;
                        filesProcessed++;
                        
                        if (filesProcessed === totalFiles) {
                            savePhotos(currentPhotos);
                            
                            successMsg.textContent = `‚úì ${uploadedCount} photo(s) saved to ${albumsList.find(a => a.id === currentAlbumId).name}!`;
                            successMsg.style.display = 'block';
                            
                            loading.style.display = 'none';
                            uploadArea.style.display = 'block';
                            chooseBtn.disabled = false;
                            fileInput.value = '';
                            uploaderName.value = '';
                            
                            setTimeout(() => { successMsg.style.display = 'none'; }, 4000);
                        }
                    };
                    reader.onerror = () => {
                        filesProcessed++;
                        if (filesProcessed === totalFiles) {
                            loading.style.display = 'none';
                            uploadArea.style.display = 'block';
                            chooseBtn.disabled = false;
                        }
                    };
                    reader.readAsDataURL(file);
                });
                
            } catch (error) {
                showError(`Save failed: ${error.message}`);
                loading.style.display = 'none';
                uploadArea.style.display = 'block';
                chooseBtn.disabled = false;
                fileInput.value = '';
            }
        }

        renderAlbumSelector();
        selectAlbum(1, 'Celebration');
    </script>
</body>
</html>
